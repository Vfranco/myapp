"use strict";app.controller("analitica",["$scope",function(e){}]),app.controller("configuracion",["$scope","Core","Form","$http","$timeout","Route",function(t,e,a,s,o,r){t.eps=[],t.arl=[],t.personalControl=[],t.cargos=[],t.formEps={},t.formCargos={},t.emptyFormEps={},t.isEmptyEps=!1,t.isEmptyArl=!1,t.isEmptyCargo=!1,t.uid=uid,t.editEps="",t.editArl="",t.editCargo="",t.formEps.idEps=0,t.formArl={},t.formArl.idArl=0,t.formCargos.idCargo=0,t.formControl={},t.formControl.idControl=0,t.isEmptyControl=!1,t.searchPersonalControl="",t.enableSearchPersonalControl=!1,t.promiseDataServer=function(e,a){return s.post(baseurl+e,a)},t.promiseDataServer("configuracion/readeps",{uid:uid}).then(function(e){e.data.status?t.eps=e.data.rows:t.eps=[]}),t.promiseDataServer("configuracion/readarl",{uid:uid}).then(function(e){e.data.status?t.arl=e.data.rows:t.arl=[]}),t.promiseDataServer("configuracion/readpersonalcontrol",{uid:uid}).then(function(e){e.data.status?t.personalControl=e.data.rows:t.personalControl=[]}),r.post("configuracion/readcargos",{uid:uid}).then(function(e){e.data.status?t.cargos=e.data.rows:t.cargos=[]}),t.muestraFormEps=!1,t.muestraFormCargo=!1,t.showFormEps=function(){t.editEps="",t.formEps.idEps=0,t.muestraFormEps=!0},t.showFormCargo=function(){t.editCargo="",t.formCargos.idCargo=0,t.muestraFormCargo=!0},t.hideFormEps=function(){t.muestraFormEps=!1,t.formEps.nombreEps=""},t.hideFormCargo=function(){t.muestraFormCargo=!1,t.formCargos.nombreCargo=""},t.showBusquedaEps=!1,t.showBusquedaArl=!1,t.showBusquedaCargo=!1,t.showPanelBusqueda=function(){t.showBusquedaEps=!0,t.muestraFormEps=!1},t.showPanelBusquedaArl=function(){t.showBusquedaArl=!0,t.muestraFormArl=!1},t.showPanelBusquedaCargo=function(){t.showBusquedaCargo=!0,t.muestraFormCargo=!1},t.hidePanelBusqueda=function(){t.showBusquedaEps=!1},t.hidePanelBusquedaArl=function(){t.showBusquedaArl=!1},t.hidePanelBusquedaCargo=function(){t.showBusquedaCargo=!1},t.setForm=function(e){t.emptyFormEps=e},t.createEps=function(){a.checkFormObject(t.formEps)?(t.message="Por favor, ingresa el nombre de la EPS que deseas registrar",t.type="danger",t.isEmptyEps=!0):t.promiseDataServer("configuracion/createeps",t.formEps).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyEps=!0,t.formEps.nombreEps="",t.promiseDataServer("configuracion/readeps",{uid:uid}).then(function(e){e.data.status?t.eps=e.data.rows:t.eps=[]})):(t.message=e.data.message,t.type="danger",t.isEmptyEps=!0)}),o(function(){t.isEmptyEps=!1,t.hideFormEps()},2e3)},t.seeOptions=0,t.selectedRow=0,t.showOptionsList=function(e){t.seeOptions=e},t.selectRowDeleteEps=function(e){t.selectedRow=e},t.cancelDeleteEps=function(){t.selectedRow=0},t.selectRowEditEps=function(e,a){t.muestraFormEps=!0,t.formEps.idEps=e,t.editEps=a},t.deleteEps=function(e){t.promiseDataServer("configuracion/deleteeps",{ideps:e}).then(function(e){e.data.status&&t.promiseDataServer("configuracion/readeps",{uid:uid}).then(function(e){e.data.status?t.eps=e.data.rows:t.eps=[]})})},t.editEpsForm=function(){a.checkFormObject(t.formEps)?(t.message="Por favor, ingresa el nombre de la EPS que deseas registrar",t.type="danger",t.isEmptyEps=!0,o(function(){t.isEmptyEps=!1,t.hideFormEps()},2e3)):t.promiseDataServer("configuracion/updateeps",t.formEps).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyEps=!0,t.formEps.nombreEps="",t.promiseDataServer("configuracion/readeps",{uid:uid}).then(function(e){e.data.status?t.eps=e.data.rows:t.eps=[]}),t.isEmptyEps=!1,t.hideFormEps()):(t.message=e.data.message,t.type="danger",t.isEmptyEps=!0)})},t.seeOptionsArl=0,t.seeOptionsCargo=0,t.selectedRowArl=0,t.selectedRowCargo=0,t.muestraFormArl=!1,t.showFormArl=function(){t.nombreArl="",t.formArl.idArl=0,t.muestraFormArl=!0},t.hideFormArl=function(){t.muestraFormArl=!1},t.createArl=function(){a.checkFormObject(t.formArl)?(t.message="Por favor, ingresa el nombre de la ARL que deseas registrar",t.type="danger",t.isEmptyArl=!0,o(function(){t.isEmptyArl=!1,t.hideFormEps()},2e3)):t.promiseDataServer("configuracion/createarl",t.formArl).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyArl=!0,t.nombreArl="",t.muestraFormArl=!1,t.promiseDataServer("configuracion/readarl",{uid:uid}).then(function(e){e.data.status?t.arl=e.data.rows:t.arl=[]})):(t.message=e.data.message,t.type="danger",t.isEmptyArl=!0)}),o(function(){t.isEmptyArl=!1},2e3)},t.showOptionsArl=function(e){t.seeOptionsArl=e},t.showOptionsCargo=function(e){t.seeOptionsCargo=e},t.selectRowDeleteArl=function(e){t.selectedRowArl=e},t.selectRowDeleteCargo=function(e){t.selectedRowCargo=e},t.selectRowEditArl=function(e,a){t.muestraFormArl=!0,t.formArl.idArl=e,t.nombreArl=a},t.selectRowEditCargo=function(e,a){t.muestraFormCargo=!0,t.formCargos.idCargo=e,t.editCargo=a},t.deleteArl=function(e){t.promiseDataServer("configuracion/deletearl",{idarl:e}).then(function(e){e.data.status&&t.promiseDataServer("configuracion/readarl",{uid:uid}).then(function(e){e.data.status?t.arl=e.data.rows:t.arl=[]})})},t.cancelDeleteArl=function(){t.selectedRowArl=0},t.cancelDeleteCargo=function(){t.selectedRowCargo=0},t.updateArl=function(){a.checkFormObject(t.formArl)?(t.message="Por favor, ingresa el nombre de la ARL que deseas registrar",t.type="danger",t.isEmptyArl=!0,o(function(){t.isEmptyArl=!1,t.hideFormArl()},2e3)):t.promiseDataServer("configuracion/updatearl",t.formArl).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyArl=!0,t.formArl.nombreArl="",t.promiseDataServer("configuracion/readarl",{uid:uid}).then(function(e){e.data.status?t.arl=e.data.rows:t.arl=[]}),t.isEmptyArl=!1,t.hideFormArl()):(t.message=e.data.message,t.type="danger",t.isEmptyArl=!0)})},t.showFormPersonalControl=!1,t.formPersonalControl=function(){t.showFormPersonalControl=!0},t.hidePersonalControl=function(){t.showFormPersonalControl=!1,t.formControl={cedula:"",nombres:"",apellidos:"",correo:"",status:!1,cargo:"",usuario:"",passone:"",passtwo:"",idControl:0,uid:uid}},t.btnCreatePersonal="Registrar",t.createPersonalControl=function(){a.checkFormObject(t.formControl)?(t.message="Por favor, ingrese los datos del empleado de control",t.type="danger",t.isEmptyControl=!0):(t.btnCreatePersonal="Creando ...",r.post("configuracion/createpersonalcontrol",t.formControl).then(function(e){e.data.status?t.promiseDataServer("configuracion/readpersonalcontrol",{uid:uid}).then(function(e){e.data.status?t.personalControl=e.data.rows:t.personalControl=[],t.btnCreatePersonal="Registrar",t.showFormPersonalControl=!1,t.formControl={cedula:"",nombres:"",apellidos:"",correo:"",status:!1,cargo:"",usuario:"",passone:"",passtwo:"",idControl:0,uid:uid}}):(t.message=e.data.message,t.type="danger",t.isEmptyControl=!0,t.btnCreatePersonal="Registrar")})),o(function(){t.isEmptyControl=!1},2e3)},t.createCargo=function(){a.checkFormObject(t.formCargos)?(t.message="Por favor, ingresa el nombre del Cargo que deseas registrar",t.type="danger",t.isEmptyCargo=!0,o(function(){t.isEmptyCargo=!1,t.hideFormCargo()},3500)):(t.promiseDataServer("configuracion/createcargo",t.formCargos).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyCargo=!0,t.formEps.nombreEps="",r.post("configuracion/readcargos",{uid:uid}).then(function(e){e.data.status?t.cargos=e.data.rows:t.cargos=[]})):(t.message=e.data.message,t.type="danger",t.isEmptyCargo=!0)}),o(function(){t.isEmptyCargo=!1,t.hideFormCargo()},2500))},t.btnDeleteCargo="Si, Borralo",t.deleteCargo=function(e){t.btnDeleteCargo="Eliminando ...",r.post("configuracion/deletecargo",{idcargo:e}).then(function(e){e.data.status&&t.promiseDataServer("configuracion/readcargos",{uid:uid}).then(function(e){e.data.status?t.cargos=e.data.rows:t.cargos=[]}),t.btnDeleteCargo="Si, Borralo"})},t.updateCargo=function(){a.checkFormObject(t.formCargos)?(t.message="Por favor, este campo no puede estar vacio",t.type="danger",t.isEmptyCargo=!0,o(function(){t.isEmptyCargo=!1,t.hideFormCargo()},2e3)):r.post("configuracion/updatecargo",t.formCargos).then(function(e){e.data.status?(t.message=e.data.message,t.type="success",t.isEmptyCargo=!0,t.formCargos.nombreCargo="",t.promiseDataServer("configuracion/readcargos",{uid:uid}).then(function(e){e.data.status?t.cargos=e.data.rows:t.cargos=[]}),t.isEmptyCargo=!1,t.hideFormCargo()):(t.message=e.data.message,t.type="danger",t.isEmptyCargo=!0)})},t.selectedRowControl=0,t.selectRowCargo=function(e){t.selectedRowControl=e},t.cancelDeletePersonal=function(){t.selectedRowControl=0},t.btnDeleteControl="Si, Borralo",t.deletePersonalControl=function(){var e=t.selectedRowControl;t.btnDeleteControl="Eliminando ...",r.post("configuracion/deletepersonalcontrol",{id:e}).then(function(e){e.data.status&&t.promiseDataServer("configuracion/readpersonalcontrol",{uid:uid}).then(function(e){e.data.status?t.personalControl=e.data.rows:t.personalControl=[],t.btnDeleteControl="Si, Borralo",t.selectedRowControl=0})})},t.selectRowCargoEdit=function(e){r.post("configuracion/readpersonalbyid",{id:e}).then(function(e){e.data.status&&(t.formControl.idControl=e.data.rows[0].id_sg_personal_control,t.formControl.status="1"==e.data.rows[0].id_sg_estado,t.formControl.cedula=parseInt(e.data.rows[0].cedula_control),t.formControl.nombres=e.data.rows[0].nombres_control,t.formControl.apellidos=e.data.rows[0].apellidos_control,t.formControl.correo=e.data.rows[0].correo_control,t.formControl.cargo=e.data.rows[0].id_sg_cargo,t.formControl.usuario=e.data.rows[0].usuario,t.formControl.passone=e.data.rows[0].recovery,t.formControl.passtwo=e.data.rows[0].recovery,t.formPersonalControl())})},t.btnUpdatePersonal="Actualizar",t.updatePersonalControl=function(){a.checkFormObject(t.formControl)?(t.message="Por favor, ingresa los datos del personal",t.type="danger",t.isEmptyControl=!0):(t.btnUpdatePersonal="Actualizando ...",r.post("configuracion/updatepersonalcontrol",t.formControl).then(function(e){e.data.status&&(t.showFormPersonalControl=!1,t.btnUpdatePersonal="Actualizar",t.promiseDataServer("configuracion/readpersonalcontrol",{uid:uid}).then(function(e){e.data.status?t.personalControl=e.data.rows:t.personalControl=[]}),t.isEmptyControl=!1)}))}}]),app.controller("contratistas",["$scope","$http","Core","Form",function(a,e,t,s){a.dataProveedores=[],a.loadDataProveedores=!1,a.getResumeProveedores=function(){e.post(baseurl+"proveedores/readbyid",{uid:uid}).then(function(e){e.data.status&&(a.dataProveedores=e.data.rows)})},a.getResumeProveedores(),a.openFormContratistas=!1,a.closeFormContratistas=!0,a.showFormContratistas=function(){a.openFormContratistas=!0},a.hideFormContratistas=function(){a.closeFormContratistas=!1}}]),app.controller("empresas",["$scope","$http","Form","$timeout","Core","$window","$location","$document",function(r,c,o,n,i,d,a,e){r.dataEmpresas=[],r.loadDataEmpresas=!1,r.emptyStatus=!1,r.showCreateForm=!1,r.uid=uid,r.setMessage=!1,r.typeMessage="",r.messageText="",r.searchEmpleado="",r.showEditForm=!1,r.showDetailsEmpleado=!1,r.triggerSearch=!1,r.result=[],r.messageConfirm=!1,r.idEmpleado=0,r.customReport=!1,r.showResumeEmpleados=!1,r.customReportInOut=!1,r.keepRegistering=!1,r.sede="",r.dataSedes=[],r.deleteSuccessSede=!1,r.showFormEditaSede=!0,r.showPlanes=!1,r.tiporegistro=1,r.cedula=0,r.telefono=0,c.post(baseurl+"empresas/readbyuser",{uid:uid}).then(function(e){if(e.data.status)for(var a in r.dataEmpresas=e.data.rows,r.dataEmpresas)r.dataEmpresas[a].estado&&(r.emptyStatus=!0);r.loadDataEmpresas=!0}),r.dataEmpleados=[],r.loadDataEmpleados=!1,r.messageEmpleados="",r.seeDetails=0,r.readEmpleados=function(){var e=c.post(baseurl+"empleados/readbyempresa",{uid:uid});r.messageEmpleados="Verificando ...",e.then(function(e){e.data.status?(r.loadDataEmpleados=!0,r.dataEmpleados=e.data.rows,r.messageEmpleados=""):(r.loadDataEmpleados=!1,r.messageEmpleados="No encontramos empleados")})},r.readEmpleados(),r.startToSearch=!1,r.$watch("result",function(e,a){e.length!=a.length&&e.length==a.length&&console.log("call")}),r.showDetails=function(e){r.showCreateForm=!1,r.showPlanes=!1,r.seeDetails=e},r.enableDetails=!1,r.requestDetails=function(e){r.idEmpleado=e,r.showResumeEmpleados=!1,r.customReportInOut=!1,r.showEditaDataEmpresa=!0,r.showEditaDataSedes=!0,r.showPlanes=!1,c.post(baseurl+"empleados/readbyid",{id_cms_empleado:e}).then(function(e){e.data.status&&(r.nombresApellidos=e.data.rows[0].nombres_personal+" "+e.data.rows[0].apellidos_personal,r.direccion=e.data.rows[0].direccion_personal,r.telefono=e.data.rows[0].telefono_personal,r.correo=e.data.rows[0].correo_personal,r.email=e.data.rows[0].correo_personal,r.photo=e.data.rows[0].photo_personal,r.enableDetails=!0,r.uid=e.data.rows[0].id_sg_personal,r.sede=e.data.rows[0].id_sg_sede.toString(),r.nombresede=e.data.rows[0].nombre_sede,r.cedula=e.data.rows[0].cedula_personal,r.nombres=e.data.rows[0].nombres_personal,r.apellidos=e.data.rows[0].apellidos_personal,r.direccion=e.data.rows[0].direccion_personal,r.telefono=e.data.rows[0].telefono_personal,r.correo=e.data.rows[0].correo_personal,r.estado=e.data.rows[0].id_sg_estado,r.showDetailsEmpleado=!1,r.showEditForm=!1)}),r.requestActividades(e)},r.dataResumenActividades=[],r.requestActividades=function(e){c.post(baseurl+"registros/obtenervisitas",{id_cms_empleado:e}).then(function(e){e.data.status?r.dataResumenActividades=e.data.rows:r.dataResumenActividades=[]})},r.cancelDetail=function(){r.uid=uid,r.enableDetails=!1,r.idEmpleado=0,o.resetForm("#frm-edita-empleado")},r.addEmpleado=function(){r.email="",r.uid=uid,r.keepRegistering=!1,r.showDetailsEmpleado=!0,r.showEditForm=!1,r.showCreateForm=!0,r.showResumeEmpleados=!1,r.customReportInOut=!1,r.showEditaDataEmpresa=!0,r.showEditaDataSedes=!0,r.showCreaDataSedes=!0,r.showPlanes=!1},r.editEmpleado=function(){r.showDetailsEmpleado=!0,r.enableDetails=!1,r.showEditForm=!0,r.keepRegistering=!1,r.showPlanes=!1},r.comebackToDetails=function(){r.uid=uid,r.showDetailsEmpleado=!1,r.showCreateForm=!1,r.showEditForm=!1,r.showPlanes=!1,o.resetForm("#frm-edita-empleado")},r.btnRegistraEmpleado=!0,r.btnActualizaEmpleado=!1,r.email="",r.checkEmail=function(){r.btnRegistraEmpleado=!0,r.email.match(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/)?(r.btnActualizaEmpleado=!1,r.btnRegistraEmpleado=!1):(r.btnRegistraEmpleado=!0,r.btnActualizaEmpleado=!0)},r.createEmpleado=function(){var e=o.OnSubmitForm({form:"#frm-create-empleado",css:".required",route:baseurl+"empleados/create",fields:"",clear:!1});1==e?(r.setMessage=!0,r.typeMessage="danger",r.messageText="Por favor, Ingrese los Datos",n(function(){r.setMessage=!1},2500)):e.then(function(e){e.data.status?(r.setMessage=!0,r.typeMessage="success",r.messageText="Has registrado tu empleado!",r.readEmpleados(),r.keepRegistering=!0,s(".comboBoxEmpleados",e.data.append.id,e.data.append.prop),o.resetForm("#frm-create-empleado"),n(function(){r.setMessage=!1})):(r.setMessage=!0,r.typeMessage="danger",r.messageText=e.data.message,n(function(){r.setMessage=!1},2500))})},r.done=function(){r.setMessage=!1,r.showCreateForm=!1,r.showEditForm=!1,r.showDetailsEmpleado=!1,r.keepRegistering=!1,r.showPlanes=!1},r.another=function(){r.uid=uid,r.keepRegistering=!1,r.showDetailsEmpleado=!0,r.showEditForm=!1,r.showCreateForm=!0,r.showResumeEmpleados=!1,r.customReportInOut=!1,r.setMessage=!1,r.showPlanes=!1},r.editaEmpleado=function(){var e=o.OnSubmitForm({form:"#frm-edita-empleado",css:".required",route:baseurl+"empleados/update",fields:"",clear:!1});1==e?(r.setMessage=!0,r.typeMessage="danger",r.messageText="Por favor, Ingrese los Datos",n(function(){r.setMessage=!1},2500)):e.then(function(e){e.data.status?(r.setMessage=!0,r.typeMessage="success",r.messageText=e.data.message,r.readEmpleados(),r.keepRegistering=!0,n(function(){r.setMessage=!1,r.showCreateForm=!1,r.showEditForm=!1,r.showDetailsEmpleado=!1,r.enableDetails=!1},2500)):(r.setMessage=!0,r.typeMessage="danger",r.messageText=e.data.message,n(function(){r.setMessage=!1},2500))})},r.activateEmpleado=function(e,a){"1"==e?(c.post(baseurl+"empleados/disable",{id_cms_empleado:a,state:"2"}).then(function(e){e.data.status&&r.readEmpleados()}),r.estado="2"):(c.post(baseurl+"empleados/disable",{id_cms_empleado:a,state:"1"}).then(function(e){e.data.status&&r.readEmpleados()}),r.estado="1")},r.showListEmpleados=!1,r.dataVisitasEmpleado=[],r.reporteVisitasSedes=[],r.seeDetailsInOut=function(){r.showDetailsActivitys=!0,r.showListEmpleados=!0,r.showDetailsEmpleado=!0,r.showResumeEmpleados=!1,r.customReportInOut=!0,r.customReport=!0,r.showCreateForm=!1,r.showEditaDataEmpresa=!0,r.showEditaDataSedes=!0,r.showEditForm=!1,r.cedulaCheck=!0,r.nombresCheck=!0,r.apellidosCheck=!0,r.sedeCheck=!0,r.entradaCheck=!0,r.salidaCheck=!0,r.showPlanes=!1,c.post(baseurl+"registros/obtenervisitas",{id_cms_empresa:uid}).then(function(e){e.data.status&&(r.dataVisitasEmpleado=e.data.rows)});var e=c.post(baseurl+"reportes/reporteporsedes",{id_cms_empresa:uid}),t=[],s=[],o=[];e.then(function(e){if(e.data.status){r.reporteVisitasSedes=e.data.rows;for(var a in r.reporteVisitasSedes)t.push(r.reporteVisitasSedes[a].sede),s.push(parseInt(r.reporteVisitasSedes[a].sede_personal)),o.push(parseInt(r.reporteVisitasSedes[a].sede_visitada));l(t,s,"#chart-bars"),u(t,s,"#chart-lines"),m(t,s,"#chart-pie"),u(t,o,"#chart-lines-visitada"),l(t,o,"#chart-bars-visitada"),m(t,o,"#chart-pie-visitada")}else r.reporteVisitasSedes=[]})};var l=function(e,a,t){var s=$(t),o=new Chart(s,{type:"bar",data:{labels:e,datasets:[{label:"Visitas",data:a}]}});s.data("chart",o)},u=function(e,a,t){var s=$(t),o=new Chart(s,{type:"line",options:{scales:{yAxes:[{gridLines:{color:Charts.colors.gray[200],zeroLineColor:Charts.colors.gray[200]},ticks:{}}]}},data:{labels:e,datasets:[{label:"Performance",data:a}]}});s.data("chart",o)},m=function(e,a,t){var s=$(t),o=new Chart(s,{type:"pie",data:{labels:e,datasets:[{data:a,backgroundColor:[Charts.colors.theme.danger,Charts.colors.theme.warning,Charts.colors.theme.success,Charts.colors.theme.primary,Charts.colors.theme.info],label:"Dataset 1"}]},options:{responsive:!0,legend:{position:"top"},animation:{animateScale:!0,animateRotate:!0}}});s.data("chart",o)};r.closeShowGraphics=function(){r.showGraphics=!1,r.showPlanes=!1},r.closeDetailsInOut=function(){r.showListEmpleados=!1,r.showDetailsEmpleado=!1,r.showResumeEmpleados=!1,r.customReportInOut=!1,r.customReport=!1,r.showPlanes=!1,r.showDetailsActivitys=!1},r.selectedId,r.selectItem=function(e){r.selectedId=e},r.deleteSuccess=!1,r.reloadingEmpleados="",r.deleteProcessEmpleado=function(e,a,t){var s=c.post(baseurl+"empleados/delete",{id_cms_empleado:e}),o=a+" "+t;r.deleteSuccess=!0,r.reloadingEmpleados="Actualizando ...",s.then(function(e){e.data.status&&(r.readEmpleados(),r.reloadingEmpleados="Empleado Eliminado",p(".comboBoxEmpleados",o),r.enableDetails=!1,n(function(){r.deleteSuccess=!1},2500))})},r.cancelProcess=function(e){r.selectedId=""},r.customeReport=function(){r.customReport=!0,r.customReportInOut=!0,r.showPlanes=!1},r.closeCustomReport=function(){r.customReport=!1,r.customReportInOut=!1,r.showPlanes=!1},r.dataDetalleEmpleados=[],r.loadDetalleEmpleados=!1,r.verMisEmpleados=function(){r.loadDetalleEmpleados=!0,r.showDetailsEmpleado=!0,r.showResumeEmpleados=!0,r.customReport=!1,r.customReportInOut=!0,r.showListEmpleados=!1,r.dataDetalleEmpleados=[],r.showEditaDataEmpresa=!0,r.showEditaDataSedes=!0,r.showCreateForm=!1,r.showPlanes=!1,r.showDetailsActivitys=!1,c.post(baseurl+"empleados/readbyempresa",{uid:uid}).then(function(e){e.data.status?r.dataDetalleEmpleados=e.data.rows:r.dataDetalleEmpleados=[],r.loadDetalleEmpleados=!1})},r.setScroll=function(e){if(5<e.length)return"setScroll"},r.increase=0,r.createdEmpresa=!1,r.showBackMessage=!1,r.modulo="",r.recoveryStep=function(){var e=d.localStorage.getItem("paso");if(i.isEmpty(e))r.increase=0;else{var a=JSON.parse(e);r.increase=a.paso,r.modulo=a.modulo,r.showBackMessage=a.left,r.tipoRegistroSigga=a.tipo}},r.next=function(e,a){switch(r.modulo=e,r.tipoRegistroSigga=a,e){case"mipersonal":r.increase++;var t=d.localStorage.getItem("paso");if(null==(s=JSON.parse(t))){var s={paso:r.increase,modulo:e,left:!0,executed:!0,uid:r.uid};r.updateTipoRegistro({tiporegistro:1,entrypoint:"#!/empresas",user:uid})}else if(s.executed)s={paso:r.increase,modulo:e,left:!0,executed:!0,uid:r.uid};d.localStorage.setItem("paso",JSON.stringify(s));break;case"visitantes":r.increase++;t=d.localStorage.getItem("paso");if(null==(s=JSON.parse(t))){s={paso:r.increase,modulo:e,left:!0,executed:!0,uid:r.uid};r.updateTipoRegistro({tiporegistro:2,entrypoint:"#!/visitantes",user:uid,control:1})}else if(s.executed)switch(a){case"residencial":s={paso:r.increase,modulo:e,left:!0,executed:!0,tipo:a,uid:r.uid};r.updateTipoControl({user:uid,control:1});break;case"empresa":s={paso:r.increase,modulo:e,left:!0,executed:!0,tipo:a,uid:r.uid};r.updateTipoControl({user:uid,control:2})}d.localStorage.setItem("paso",JSON.stringify(s));break;case"proveedores":r.increase++;s={paso:r.increase,modulo:e,left:!0,executed:!0,uid:r.uid};r.updateTipoRegistro({tiporegistro:2,entrypoint:"#!/proveedores",user:uid,control:2,uid:r.uid}),d.localStorage.setItem("paso",JSON.stringify(s))}},r.updateTipoRegistro=function(e){c.post(baseurl+"usuarios/updatetiporegistro",e).then(function(e){if(e.data.status)return!0})},r.updateTipoControl=function(e){c.post(baseurl+"usuarios/updatetipocontrol",e).then(function(e){if(e.data.status)return!0})},r.prev=function(){r.increase--;var e={paso:r.increase,left:!0};d.localStorage.setItem("paso",e)},r.recoveryStep(),r.errorMessageEmpresa="",r.errorMessageUnidad="",r.errorCreated=!1,r.createUnidad=!1,r.createUnidadResidencial=function(){var e=o.OnSubmitForm({form:"#frm-create-unidad",css:".required",route:baseurl+"unidad/create",fields:"",clear:!1});1==e?(r.errorMessageUnidad="Por favor, Ingresa los datos de tu empresa",r.errorCreated=!0):e.then(function(e){e.data.status?(r.createdUnidad=!0,o.resetForm("#frm-create-unidad")):(r.errorMessageUnidad="Ocurrio algo!, no hemos podido crear tu Unidad, porfavor intentalo de nuevo",r.errorCreated=!0)})},r.createempresa=function(){var e=o.OnSubmitForm({form:"#frm-create-empresa",css:".required",route:baseurl+"empresas/create",fields:"",clear:!1});1==e?(r.errorMessageEmpresa="Por favor, Ingresa los datos de tu empresa",r.errorCreated=!0):e.then(function(e){e.data.status?(r.createdEmpresa=!0,o.resetForm("#frm-create-empresas")):(r.errorMessageEmpresa=e.data.message,r.errorCreated=!0)})},r.errorMessageEmpresaVisitante="",r.errorCreatedEmpresaVisitante=!1,r.createEmpresaVisitante=function(){var e=o.OnSubmitForm({form:"#frm-create-empresa-visitante",css:".required",route:baseurl+"empresas/create",fields:"",clear:!1});1==e?(r.errorMessageEmpresaVisitante="Por favor, Ingresa los datos de tu empresa",r.errorCreatedEmpresaVisitante=!0):e.then(function(e){e.data.status?(r.errorCreatedEmpresaVisitante=!0,o.resetForm("#frm-create-empresa-visitante")):(r.errorMessageEmpresaVisitante=e.data.message,r.errorCreatedEmpresaVisitante=!0)})},r.btnUpdateEmpresa="Actualiza mi Empresa",r.editaempresa=function(){r.btnUpdateEmpresa="Actualizando...";var e=o.OnSubmitForm({form:"#frm-edita-empresa",css:".required",route:baseurl+"empresas/update",fields:"",clear:!1});1==e?(r.errorMessageEmpresa="Por favor, Ingresa los datos de tu empresa",r.typeMessage="danger",r.errorCreated=!0):(e.then(function(e){e.data.status?(r.errorCreated=!0,r.errorMessageEmpresa=e.data.message,r.typeMessage="success"):(r.errorMessageEmpresa=e.data.message,r.errorCreated=!0,r.typeMessage="danger")}),r.btnUpdateEmpresa="Actualiza mi Empresa")},r.errorMessageSede="",r.errorCreatedSede=!1,r.createdSede=!1,r.createSede=function(){var e=o.OnSubmitForm({form:"#frm-create-sede",css:".required",route:baseurl+"sedes/create",fields:"",clear:!1});1==e?(r.errorMessageSede="Por favor, Ingresa los datos de tu sede",r.errorCreatedSede=!0):e.then(function(e){e.data.status?(r.typeMessage="success",r.errorMessageSede=e.data.message,r.errorCreatedSede=!0,r.createdSede=!0,o.resetForm("#frm-create-sede")):(r.typeMessage="danger",r.errorMessageSede=e.data.message,r.errorCreatedSede=!0),r.getDataSedes(uid,e.data.status)})},r.errorMessageSedeVisitante="",r.errorCreatedSedeVisitante=!1,r.createSedeVisitante=function(){var e=o.OnSubmitForm({form:"#frm-create-sede-visitante",css:".required",route:baseurl+"sedes/create",fields:"",clear:!1});1==e?(r.errorMessageSedeVisitante="Por favor, ingrese los datos",r.errorCreatedSedeVisitante=!0):e.then(function(e){e.data.status?(r.typeMessage="success",r.errorMessageSedeVisitante=e.data.message,r.errorCreatedSedeVisitante=!0,r.createdSedeVisitante=!0,o.resetForm("#frm-create-sede")):(r.typeMessage="danger",r.errorMessageSedeVisitante=e.data.message,r.errorCreatedSedeVisitante=!0),r.getDataSedes(uid,e.data.status)})},r.getInSigga=function(){var e=d.localStorage.getItem("paso");switch(JSON.parse(e).modulo){case"mipersonal":d.location.reload(),d.localStorage.removeItem("paso"),location.reload();break;case"visitantes":a.path("/visitantes"),d.localStorage.removeItem("paso"),location.reload();break;case"proveedores":a.path("/proveedores"),d.localStorage.removeItem("paso")}},r.goToSection=function(){a.hash("detalles"),$anchorScroll()},r.showEditaDataEmpresa=!0,r.showEditaDataSedes=!0,r.loadDataSedes=!1,r.messageSedes="",r.searchSedes="",r.editarEmpresa=function(){r.showEditaDataEmpresa=!1,r.showDetailsActivitys=!1,r.showDetailsEmpleado=!0,r.customReportInOut=!0,r.showEditaDataSedes=!0,r.showResumeEmpleados=!1,r.showListEmpleados=!1,r.customReportInOut=!0,r.customReport=!1,r.showEditForm=!1,r.showCreateForm=!1,r.showPlanes=!1,c.post(baseurl+"empresas/readbyid",{id_cms_empresas:uid}).then(function(e){e.data.status&&(r.idEmpresa=e.data.rows[0].id_sg_empresa,r.empresa=e.data.rows[0].empresa,r.nit=e.data.rows[0].nit,r.correo=e.data.rows[0].email,r.direccion=e.data.rows[0].direccion,r.estado=e.data.rows[0].estado)})},r.editarSede=function(){r.showDetailsActivitys=!1,r.showEditaDataSedes=!1,r.showDetailsEmpleado=!0,r.customReportInOut=!0,r.showResumeEmpleados=!1,r.showListEmpleados=!1,r.customReportInOut=!0,r.customReport=!1,r.showEditForm=!1,r.showCreateForm=!1,r.showPlanes=!1,r.getDataSedes(uid,!1)},r.closeSede=function(){r.showEditaDataEmpresa=!0,r.showDetailsEmpleado=!1,r.customReportInOut=!1,r.showEditaDataSedes=!0,r.errorCreated=!1,r.showPlanes=!1},r.closeEditEmpresa=function(){r.showEditaDataEmpresa=!0,r.showDetailsEmpleado=!1,r.customReportInOut=!1,r.showEditaDataSedes=!0,r.errorCreated=!1,r.showPlanes=!1},r.getDataSedes=function(e,a){c.post(baseurl+"sedes/readbyidempresa",{idusuario:e}).then(function(e){e.data.status&&(r.dataSedes=e.data.rows,a&&(s(".comboBoxSedes",e.data.rows[0].id_sg_sede,e.data.rows[0].nombre_sede),s(".comboBoxSedeEdit",e.data.rows[0].id_sg_sede,e.data.rows[0].nombre_sede),s(".comboBoxSedesCreate",e.data.rows[0].id_sg_sede,e.data.rows[0].nombre_sede)))})},r.showCreaDataSedes=!0,r.addSede=function(){r.showCreaDataSedes=!1,r.showEditaDataSedes=!0,r.errorCreatedSede=!1,r.showPlanes=!1},r.cancelAddSede=function(){r.showCreaDataSedes=!0,r.showEditaDataSedes=!1,r.createdSede=!1,r.showFormEditaSede=!0,r.showPlanes=!1},r.doneSede=function(){r.errorCreatedSede=!0,r.cancelAddSede()},r.anotherSede=function(){r.errorCreatedSede=!1,r.errorMessageSede="",r.createdSede=!1,r.addSede()},r.editSede=function(e){r.showEditaDataSedes=!0,r.showFormEditaSede=!1,r.errorCreatedSede=!1,r.showPlanes=!1,c.post(baseurl+"sedes/readbyid",{id_cms_sede:e}).then(function(e){e.data.status&&(o.resetForm("#frm-edita-sede"),r.idSede=e.data.rows[0].id_sg_sede,r.nombreSede=e.data.rows[0].nombre_sede,r.dirSede=e.data.rows[0].direccion_sede,r.telefonoSede=e.data.rows[0].telefono_sede)})},r.editProcessData=function(){var e=o.OnSubmitForm({form:"#frm-edita-sede",css:".required",route:baseurl+"sedes/update",fields:"",clear:!1});1==e?(r.errorMessageSede="Por favor, Ingresa los datos de tu sede",r.errorCreatedSede=!0):e.then(function(e){e.data.status?(r.typeMessage="success",r.errorMessageSede=e.data.message,r.errorCreatedSede=!0,r.createdSede=!0,r.readEmpleados()):(r.typeMessage="danger",r.errorMessageSede=e.data.message,r.errorCreatedSede=!0),r.getDataSedes(uid)})},r.deleteProcessSede=function(a){var e=c.post(baseurl+"sedes/delete",{id_cms_sede:a});r.deleteSuccessSede=!0,r.reloadingSede="Actualizando ...",r.typeMessage="info",e.then(function(e){e.data.status?(r.getDataSedes(uid),r.reloadingSede="Sede Eliminada",r.enableDetails=!1,r.selectedId="",r.typeMessage="success",t(".comboBoxSedes",a),t(".comboBoxSedesCreate",a),n(function(){r.deleteSuccessSede=!1},2500)):(r.reloadingSede=e.data.message,r.enableDetails=!1,r.selectedId="",r.typeMessage="danger",n(function(){r.deleteSuccessSede=!1},4e3))})};var t=function(e,a){$(e+' option[value="'+a+'"]').each(function(){$(this).remove()})},p=function(e,a){$(e+" option").each(function(){$(this).text()===a&&$(this).remove()})},s=function(e,a,t){$(e).append('<option value="'+a+'">'+t+"</option>")};r.arguments=[],r.cedulaCheck=!0,r.nombresCheck=!0,r.apellidosCheck=!0,r.sedeCheck=!0,r.entradaCheck=!0,r.salidaCheck=!0,r.sedeOption="",r.fechaDesde="",r.fechaHasta="",r.entradaSalidaOption="",r.empleadoOption="",r.showMessageErrorReporte=!1,r.generateReporte=function(){var e=o.serializeForm('#frm-generate-report input[type="checkbox"]');if(r.arguments=[],i.isEmpty(r.sedeOption)||i.isEmpty(r.fechaDesde)||i.isEmpty(r.fechaHasta)||i.isEmpty(r.entradaSalidaOption))r.showMessageErrorReporte=!0;else{for(var a in r.showMessageErrorReporte=!1,e)"on"==e[a]&&r.arguments.push(a);if(i.isEmpty(r.empleadoOption))t={fields:r.arguments.join(", "),id_cms_empresa:uid,desde:f(r.fechaDesde),hasta:f(r.fechaHasta),sede:r.sedeOption,entradaSalida:r.entradaSalidaOption};else var t={fields:r.arguments.join(", "),id_cms_empresa:uid,desde:f(r.fechaDesde),hasta:f(r.fechaHasta),sede:r.sedeOption,entradaSalida:r.entradaSalidaOption,empleado:r.empleadoOption};var s=c.post(baseurl+"registros/obtenerreporteactividades",t);r.dataVisitasEmpleado=[],s.then(function(e){e.data.status?r.dataVisitasEmpleado=e.data.rows:r.dataVisitasEmpleado=[]})}};var f=function(e){var a=new Date(e);return a.getFullYear()+"-"+g(a.getMonth()+1)+"-"+g(a.getDate())},g=function(e){return e<10?"0"+e:e};r.exportToExcel=function(e,a,t){for(var s=c.post(baseurl+e,t),o=$(a),r=[],n=0;n<o.length;n++){var i=o[n];r.push(i.textContent)}var d=[],l=[];d.push(r),s.then(function(e){e.data.status&&$.each(e.data.rows,function(e,a){l=[],$.each(a,function(e,a){l.push(a)}),d.push(l)}),d.push(l);var a=XLSX.utils.book_new(),t=XLSX.utils.aoa_to_sheet(d);XLSX.utils.book_append_sheet(a,t,"Sigga_Mi_Personal"),XLSX.writeFile(a,"Reporte_Mi_Personal.xlsx")})},r.generateReportPDF=function(){},r.showGraphics=!1,r.showResumeGraphics=function(){r.showGraphics=!0},r.showPlanesData=function(){r.showPlanes=!0,r.showListEmpleados=!0,r.showDetailsEmpleado=!0,r.customReportInOut=!0,r.showDetailsActivitys=!1,r.customReport=!1},$(".tooltip-message").tooltip()}]),app.controller("personal",["$scope",function(e){console.log("esta es una prueba")}]),app.controller("reportes",["$scope",function(e){console.log("esta es una prueba")}]),app.controller("residencial",["$scope","$http","Core","Form","$timeout",function(t,s,e,a,o){t.uid=uid,t.dataApartamentos=[],t.dataTorres=[],t.dataResidentes=[],t.dataIntegrantes=[],t.loadDataApartamentos=!1,t.loadDataTorres=!1,t.cedula=0,t.telefono=0,t.torre="",t.dataResource=[],t.searchApartamento="",t.pisoapto=0,t.searchTorre="",t.getApartamentos=function(){s.post(baseurl+"apartamentos/readbyid",{uid:uid}).then(function(e){e.data.status&&(t.dataApartamentos=e.data.rows,t.dataResource=e.data.rows,t.loadDataApartamentos=!0)})},t.getTorres=function(){s.post(baseurl+"torres/readbyid",{uid:uid}).then(function(e){e.data.status&&(t.dataTorres=e.data.rows,t.loadDataTorres=!0)})},t.getApartamentos(),t.getTorres(),t.detalleApto=!0,t.estadoFormApto=!1,t.estadoFormTorre=!1,t.openAddApto=function(){t.torre="",t.pisoapto=0,t.nombreapto="",t.estadoapto="0",t.detalleApto=!1,t.estadoFormApto=!0,t.showEditFormApto=!1},t.closeAddApto=function(){t.detalleApto=!0,t.estadoFormApto=!1},t.openAddTorre=function(){"2"==t.torre&&(t.estadoFormApto=!1,t.estadoFormTorre=!0,t.showDetallesTorres=!1),"0"==t.torre&&(t.estadoFormResidente=!0,t.estadoFormApto=!1,t.estadoFormTorre=!1,t.showDetallesTorres=!1)},t.openAddTorreList=function(){t.estadoFormApto=!1,t.estadoFormTorre=!0,t.showDetallesTorres=!1},t.closeAddTorre=function(){t.estadoFormApto=!0,t.estadoFormTorre=!1},t.showDetallesTorres=!1,t.openTorre=function(){t.estadoFormApto=!1,t.detalleApto=!1,t.showDetallesResidente=!1,t.showDetallesTorres=!0},t.closeListTorre=function(){t.detalleApto=!0,t.showDetallesTorres=!1},t.selectIdTorre=0,t.verBotones=0,t.mostrarBotonesTorre=function(e){t.verBotones=e},t.selectTorre=function(e){t.selectIdTorre=e},t.cancelDeleteTorre=function(){t.selectIdTorre=0},t.messageDeleteTorre=!1,t.showMessageDeleteTorre="",t.deleteProcessTorre=function(e){s.post(baseurl+"torres/delete",{idTorre:e}).then(function(e){e.data.status?t.type="success":t.type="danger",t.showMessageDeleteTorre=!0,t.messageDeleteTorre=e.data.message}),o(function(){t.showMessageDeleteTorre=!1,t.getTorres()},2500)},t.btnCreateTorre="Registrar Torre",t.showMessageTorre=!1,t.type="",t.createTorre=function(){var e=a.OnSubmitForm({form:"#frm-create-torre",css:".required",route:baseurl+"torres/create",fields:"",clear:!0});t.btnCreateTorre="Registrando ...",1==e?(t.type="danger",t.messageErrorTorre="Por favor, ingrese el nombre de la torre",t.showMessageTorre=!0,t.btnCreateTorre="Registrar Torre"):e.then(function(e){e.data.status?(t.type="success",t.messageErrorTorre=e.data.message,t.showMessageTorre=!0,t.btnCreateTorre="Registrar Torre",t.getTorres()):(t.type="danger",t.messageErrorTorre=e.data.message,t.showMessageTorre=!0)}),o(function(){t.showMessageTorre=!1},2500)},t.btnCreateApto="Registrar",t.messageErrorApto="",t.showMessageApto=!1,t.type="",t.createApto=function(){var e=a.OnSubmitForm({form:"#frm-create-apto",css:".required",route:baseurl+"apartamentos/create",fields:"",clear:!1});t.btnCreateApto="Registrando ...",1==e?(t.type="danger",t.messageErrorApto="Por favor, ingresa los datos del Apartamento",t.showMessageApto=!0,t.btnCreateApto="Registrar"):e.then(function(e){e.data.status?(t.type="success",t.messageErrorApto=e.data.message,t.showMessageApto=!0,t.btnCreateApto="Registrar",t.closeAddApto(),t.getApartamentos(),a.resetForm("#frm-create-apto")):(t.type="danger",t.messageErrorApto=e.data.message,t.showMessageApto=!0,t.btnCreateApto="Registrar")}),o(function(){t.showMessageApto=!1},2500)},t.verDetalle=0,t.selectIdApto=0,t.muestraMensajeCarga="No hay detalles que mostrar",t.resultDataApto=!1,t.dataDetalles=[],t.mostrarDetalles=function(e){t.verDetalle=e},t.opcionesApto=!1,t.requestDetalles=function(e){var a=s.post(baseurl+"apartamentos/readbyidapto",{id:e});t.gridApartamentos=!1,t.detalleApto=!0,t.estadoFormApto=!1,t.showDetallesTorres=!1,t.showDetallesResidente=!1,t.muestraMensajeCarga="Cargando detalles ...",a.then(function(e){e.data.status&&(t.dataDetalles=e.data.rows[0],t.resultDataApto=!0,t.idApto=t.dataDetalles.id_sg_apto,t.torre=t.dataDetalles.id_sg_torre,$("#estadoApto").val(t.dataDetalles.id_sg_estado).change(),t.pisoapto=parseInt(t.dataDetalles.piso_apto),t.nombreapto=t.dataDetalles.numero_apto,t.dataIntegrantes=e.data.residentes),t.opcionesApto=!0,t.muestraMensajeCarga="No hay detalles que mostrar"})},t.showEditFormApto=!1,t.openEditForm=function(){t.requestDetalles(t.idApto),t.estadoFormApto=!0,t.detalleApto=!1,t.showEditFormApto=!0},t.cancelEditApto=function(){t.resultDataApto=!1,t.opcionesApto=!1,t.dataIntegrantes=[]},t.btnActualizaApto="Actualizar",t.updateApto=function(){var e=a.OnSubmitForm({form:"#frm-create-apto",css:".required",route:baseurl+"apartamentos/update",fields:"",clear:!1});t.btnActualizaApto="Actualizando ...",1==e?(t.type="danger",t.messageErrorApto="Por favor, ingresa los datos del Apartamento",t.showMessageApto=!0,t.btnActualizaApto="Actualizar"):e.then(function(e){e.data.status?(t.type="success",t.messageErrorApto=e.data.message,t.showMessageApto=!0,t.btnActualizaApto="Actualizar",t.getApartamentos(),a.resetForm("#frm-create-apto")):(t.type="danger",t.messageErrorApto=e.data.message,t.showMessageApto=!0,t.btnActualizaApto="Actualizar")}),o(function(){t.showMessageApto=!1},2500)},t.selectItem=function(e){t.selectIdApto=e},t.type="danger",t.messageDeleteApto="",t.showMessageDeleteApto=!1,t.deleteProcessApto=function(e){s.post(baseurl+"apartamentos/delete",{id:e}).then(function(e){e.data.status?(t.type="success",t.messageDeleteApto=e.data.message,t.showMessageDeleteApto=!0,t.resultDataApto=!1,t.getApartamentos()):(t.type="danger",t.messageDeleteApto=e.data.message,t.showMessageDeleteApto=!0)}),o(function(){t.showMessageDeleteApto=!1},3e3)},t.cancelDelete=function(){t.selectIdApto=0},t.btnCreateResidente="Registrar Residente",t.btnDisableCreate=!0,t.messageErrorResidente="",t.showMessageResidente=!1,t.createResidente=function(){var e=a.OnSubmitForm({form:"#frm-create-residente",css:".required",route:baseurl+"residentes/create",fields:"",clear:!1});t.btnCreateResidente="Registrando ...",t.btnDisableCreate=!0,1==e?(t.type="danger",t.messageErrorResidente="Por favor, ingresa los datos del Apartamento",t.showMessageResidente=!0,t.btnCreateResidente="Registrar Residente"):e.then(function(e){e.data.status?(t.type="success",t.messageErrorResidente=e.data.message,t.showMessageResidente=!0,t.btnCreateResidente="Registrar Residente",t.estadoFormResidente=!1,t.estadoFormApto=!1,t.estadoFormResidente=!1,t.showDetallesResidente=!0,t.addResidente(),a.resetForm("#frm-create-residente")):(t.type="danger",t.messageErrorResidente=e.data.message,t.showMessageResidente=!0,t.btnDisableCreate=!1,t.btnCreateResidente="Registrar Residente")}),o(function(){t.showMessageResidente=!1},2500)},t.closeAddResidente=function(){t.estadoFormApto=!1,t.estadoFormResidente=!1,t.showDetallesResidente=!0},t.correo="",t.checkEmail=function(){t.btnDisableCreate=!0,t.correo.match(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/)?t.btnDisableCreate=!1:t.btnDisableCreate=!0},t.setScroll=function(e){if(5<e.length)return"setScroll"},t.showDetallesResidente=!1,t.loadDataResidentes=!1,t.addResidente=function(){t.showDetallesResidente=!0,t.detalleApto=!1,s.post(baseurl+"residentes/readbyid",{uid:uid}).then(function(e){e.data.status&&(t.dataResidentes=e.data.rows,t.loadDataResidentes=!0)})},t.closeListResidente=function(){t.detalleApto=!0,t.showDetallesResidente=!1},t.selectIdResidente=0,t.selectResidente=function(e){t.selectIdResidente=e},t.cancelDeleteResidente=function(){t.selectIdResidente=0},t.selectIdResidenteAsignar=0,t.asignaResidente=function(e){t.selectIdResidenteAsignar=e},t.cancelAsignacion=function(){t.selectIdResidenteAsignar=0},t.btnAsignacion="Si, Asignalo",t.messageAsignaResidente="",t.showMessageAsignaResidente=!1,t.processAsignacion=function(e){var a=s.post(baseurl+"residentes/asigna",{idResidente:e,idApto:t.idApto,idTorre:t.torre,uid:uid});if(t.btnAsignacion="Asignado ...",1==a)return!1;a.then(function(e){e.data.status?(t.type="success",t.messageAsignaResidente=e.data.message,t.showMessageAsignaResidente=!0,t.requestDetalles(t.idApto)):(t.type="danger",t.messageAsignaResidente=e.data.message,t.showMessageAsignaResidente=!0),t.btnAsignacion="Si, Asignalo"}),o(function(){t.showMessageAsignaResidente=!1},2500)},t.messageDeleteResidente="",t.showmessageDeleteResidente=!1,t.deleteProcessResidente=function(e){s.post(baseurl+"residentes/delete",{id:e}).then(function(e){e.data.status?t.type="success":t.type="danger",t.messageDeleteResidente=e.data.message,t.showmessageDeleteResidente=!0,t.addResidente()}),o(function(){t.selectIdResidenteAsignar=0,t.showmessageDeleteResidente=!1},2500)},t.openFormResidente=function(){t.showDetallesResidente=!1,t.detalleApto=!1,t.estadoFormResidente=!0},t.residenteAsignado=0,t.removerResidente=function(e){t.residenteAsignado=e},t.cancelaRemover=function(){t.residenteAsignado=0},t.messageDeleteResidente="",t.showMessageDeleteResidente=!1,t.eliminaResidente=function(e){s.post(baseurl+"residentes/desasignar",{id:e}).then(function(e){e.data.status&&(t.type="success",t.messageDeleteResidente=e.data.message,t.showMessageDeleteResidente=!0,t.dataIntegrantes=[])}),o(function(){t.showMessageDeleteResidente=!1},2500)},t.gridApartamentos=!1,t.gridResidente=!1,t.panelApto=!1,t.panelResidente=!1,t.panelDetalleResidente=!1,t.closeDetalleApartamentos=function(){t.panelApto=!1,t.panelResidente=!1,t.gridApartamentos=!1,t.panelDetalleResidente=!1},t.verGridApartamentos=function(){t.panelApto=!0,t.panelResidente=!0,t.gridApartamentos=!0,t.panelDetalleResidente=!0,t.gridResidentes=!1},t.gridDetalleResidentes=[],t.loadgridDetalleResidentes=!1,t.verGridResidentes=function(){t.panelApto=!0,t.panelResidente=!1,t.gridApartamentos=!1,t.panelDetalleResidente=!0,t.gridResidentes=!0;var e=s.post(baseurl+"residentes/readresidentedetalles",{uid:uid});t.loadgridDetalleResidentes=!0,e.then(function(e){e.data.status&&(t.gridDetalleResidentes=e.data.rows,t.loadgridDetalleResidentes=!1)})},t.closeDetalleResidentes=function(){t.gridResidentes=!1,t.panelApto=!1,t.panelDetalleResidente=!1}}]),app.controller("terminales",["$scope","$http","Core","Form","$timeout","Route",function(s,a,e,t,o,r){s.terminales=[],s.loadTerminales=!1,s.showMessageEmpty=!0,s.showGridTerminales=!1,s.formTerminal={},s.emptyFormTerminal={},s.uid=uid,s.enableSearchTerminal=!1,s.searchTerminal="",s.idTerminal=0,s.searchTerminal="",s.loadCreatedTerminals=function(){var e=a.post(baseurl+"UsuariosTerminal/ReadById",{uid:uid});s.loadTerminales=!0,e.then(function(e){e.data.status&&(s.terminales=e.data.rows),s.loadTerminales=!0})},s.loadCreatedTerminals(),s.setForm=function(e){s.emptyFormTerminal=e},s.showFormTerminal=!1,s.statusCreatedTerminal=!1,s.terminalMessage="",s.showFormCreateTerminal=function(){s.showFormTerminal=!0,s.showMessageEmpty=!1,s.showGridTerminales=!0,s.statusCreatedTerminal=!1,s.formTerminal={idTerminal:0,arl:!1,confirm:"",cursos:!1,eps:!1,status:!1,nombreUsuario:"",passone:"",photo:!1,sede:"",tipo:"",uid:uid}},s.hideFormCreateTerminal=function(){s.showFormTerminal=!1,s.showGridTerminales=!1},s.isEmpty=!1,s.btnCreateTerminal="Registrar Terminal",s.createTerminal=function(){t.checkFormObject(s.formTerminal)?(s.message="Por favor, ingresa los datos de tu terminal",s.type="danger",s.isEmpty=!0):(s.btnCreateTerminal="Registrando ...",a.post(baseurl+"UsuariosTerminal/CreateUserTerminal",s.formTerminal).then(function(e){e.data.status?(s.message=e.data.message,s.type="success",s.createdTerminal=!0,s.showGridTerminales=!1,s.loadCreatedTerminals(),s.formTerminal={idTerminal:0,arl:!1,confirm:"",cursos:!1,eps:!1,status:!1,nombreUsuario:"",passone:"",photo:!1,sede:"",tipo:"",uid:uid}):(s.message=e.data.message,s.type="danger",s.isEmpty=!0),s.btnCreateTerminal="Registrar Terminal"}));o(function(){s.isEmpty=!1},2500)},s.cancelCreateTerminal=function(){s.showFormTerminal=!1,s.showGridTerminales=!1},s.comeBackCreatedTerminal=function(){s.showGridTerminales=!1,s.showFormTerminal=!1,s.showMessageEmpty=!1},s.seeOptions=0,s.selectedRow=0,s.showOptionsList=function(e){s.seeOptions=e},s.selectRowDeleteTerminal=function(e){s.selectedRow=e},s.btnDeleteTerminal="Si, Borralo",s.deleteTerminal=function(e){s.btnDeleteTerminal="Eliminando ...",r.post("UsuariosTerminal/DeleteTerminal",{id:e}).then(function(e){e.data.status&&(s.selectedRow=0,s.loadCreatedTerminals()),s.btnDeleteTerminal="Si, Borralo"})},s.cancelDeleteTerminal=function(){s.selectedRow=0},s.loadFormEdit="pen",s.selectRowEditTerminal=function(e){s.loadFormEdit="ellipsis-h",r.post("UsuariosTerminal/ReadByEdit",{id:e}).then(function(e){if(e.data.status){var a=e.data.rows[0],t=JSON.parse(e.data.rows[0].formulario);s.formTerminal={idTerminal:a.id_sg_terminal_usuario,arl:t.arl,confirm:a.recovery,cursos:t.cursos,eps:t.eps,status:1==a.id_sg_estado,nombreUsuario:a.usuario,passone:a.recovery,photo:t.photo,sede:a.id_sg_sede,tipo:a.id_sg_tipo_control,uid:uid},s.showFormTerminal=!0,s.showGridTerminales=!0,s.loadFormEdit="pen"}})},s.btnUpdateTerminal="Actualizar Terminal",s.updateTerminal=function(){s.btnUpdateTerminal="Actualizando ...",r.post("UsuariosTerminal/UpdateTerminal",s.formTerminal).then(function(e){e.data.status&&(s.btnUpdateTerminal="Actualizar Terminal",s.showFormTerminal=!1,s.showGridTerminales=!1,s.loadCreatedTerminals())})}}]),app.controller("usuarios",["$scope",function(e){console.log("esta es una prueba")}]),app.controller("visitantes",["$scope","$http","rx","Form","$timeout",function(t,s,e,a,o){var r="1"==tipocontrol?"apartamentos/":"oficinas/";t.uid=uid,t.dataResource=[],t.loadDataResource=!1,t.searchResource="",t.selectedIdResource="",t.cedula=0,t.telefono=0,t.showCreateForm=!1,t.seeDetails=0,t.resultResource=!1,t.panelTorre=!1,t.enableFormTorre=!1,t.muestraMensajeCarga="No hay datos que mostrar",t.idOficina=0,t.searchEmpleado="",t.searchTorre="",t.searchIntegrante="",s.post(baseurl+r+"readbyid",{uid:uid}).then(function(e){e.data.status?(t.dataResource=e.data.rows,t.loadDataResource=!0):t.loadDataResource=!1}),t.openTorre=function(){t.panelTorre=!0,t.ocultaDetalleOficina=!0,t.enableFormTorre=!1,t.ocultaDetalleOficina=!0,t.ocultaFormCreacionOficina=!1,t.integrantesOficina=[]},t.item="",t.piso="",t.disableInputs=!1,t.changeFormTorre=function(){"N/A"==$("#idTorre option:selected").text()?(t.piso="N/A",t.disableInputs=!0):(t.piso="",t.disableInputs=!1,2==t.item?t.enableFormTorre=!0:t.enableFormTorre=!1)},t.closeTorre=function(){t.panelTorre=!1,t.ocultaDetalleOficina=!1},t.cancelAddTorre=function(){t.enableFormTorre=!1,t.item=""},t.createdTorre=!1,t.muestraErrorTorre=!1,t.mensajeErrorTorre="",t.tipoMensaje="",t.createTorre=function(){var e=a.OnSubmitForm({form:"#frm-create-torre",css:".required",route:baseurl+"torres/create",fields:"",clear:!0});1==e?(t.muestraErrorTorre=!0,t.mensajeErrorTorre="Por favor, ingresa los datos de la torre",t.tipoMensaje="danger"):e.then(function(e){e.data.status&&(t.muestraErrorTorre=!0,t.mensajeErrorTorre=e.data.message,t.tipoMensaje="success",t.enableFormTorre=!1,t.item="",t.readTorres())}),o(function(){t.muestraErrorTorre=!1},2500)},t.dataTorres=[],t.readTorres=function(){"2"==tipocontrol&&s.post(baseurl+"torres/readbyid",{uid:uid}).then(function(e){e.data.status&&(t.dataTorres=e.data.rows)})},t.readOficinas=function(){s.post(baseurl+r+"readbyid",{uid:uid}).then(function(e){e.data.status?(t.dataResource=e.data.rows,t.loadDataResource=!0):t.loadDataResource=!1})},t.readTorres(),t.selectedTorre=0,t.detallesTorre=function(e){t.selectedTorre=e},t.showDeleteOption=function(e){t.torreToDelete=e},t.cancelTorreDelete=function(){t.torreToDelete=0},t.deleteTorre=function(e){s.post(baseurl+"torres/delete",{idTorre:e}).then(function(e){e.data.status?(t.muestraErrorTorre=!0,t.tipoMensaje="success",t.mensajeErrorTorre=e.data.message,t.torreToDelete=0,t.readTorres()):(t.muestraErrorTorre=!0,t.tipoMensaje="danger",t.mensajeErrorTorre=e.data.message)}),o(function(){t.muestraErrorTorre=!1},2500)},t.showDetails=function(e){t.seeDetails=e},t.selectItem=function(e){t.selectedIdResource=e},t.nombreTorre="",t.nombreOficina="",t.pisoNivel="",t.area="",t.integrantesOficina=[],t.requestDetails=function(e){(t.ocultaDetalleOficina=!1,t.ocultaFormCreacionOficina=!1,t.panelTorre=!1,t.listarIntegrantes=!1,"2"==tipocontrol)&&(t.muestraMensajeCarga="Cargando Oficinas ...",s.post(baseurl+r+"readbyidoficina",{id_oficina:e}).then(function(e){e.data.status&&(t.idOficina=e.data.rows[0].id_sg_oficina,t.nombreTorre=e.data.rows[0].nombre_torre,t.nombreOficina=e.data.rows[0].oficina,t.pisoNivel=e.data.rows[0].piso_nivel,t.area=e.data.rows[0].area,t.integrantesOficina=e.data.integrantes,t.resultResource=!0,$("#idTorre").val(e.data.rows[0].id_sg_torre).change(),t.item=e.data.rows[0].id_sg_torre,t.piso=e.data.rows[0].piso_nivel,t.oficina=e.data.rows[0].oficina,t.area=e.data.rows[0].area),t.muestraMensajeCarga="No hay datos que mostrar"}))},t.ocultaDetalleOficina=!1,t.ocultaFormCreacionOficina=!1,t.buttonCreateOficina=!0,t.addOffice=function(){t.buttonCreateOficina=!0,t.ocultaDetalleOficina=!0,t.ocultaFormCreacionOficina=!0,t.panelTorre=!1,t.item="",t.piso="",t.oficina="",t.area=""},t.oficinaMessage="",t.showMessageOficina=!1,t.recordCreated=!1,t.createOficina=function(){var e=a.OnSubmitForm({form:"#frm-create-oficina",css:".required",route:baseurl+"oficinas/create",fields:"",clear:!1});1==e?(t.oficinaMessage="Por favor, ingresa los datos de la oficina",t.showMessageOficina=!0):e.then(function(e){e.data.status&&(t.oficinaMessage=e.data.message,t.recordCreated=!0,a.resetForm("#frm-create-oficina"),s.post(baseurl+r+"readbyid",{uid:uid}).then(function(e){e.data.status?(t.dataResource=e.data.rows,t.loadDataResource=!0):t.loadDataResource=!1}))})},t.borraMensajeError=function(){t.showMessageOficina=!1},t.borraMensajeSuccess=function(){a.resetForm("#frm-create-oficina"),t.recordCreated=!1,t.ocultaDetalleOficina=!1,t.ocultaFormCreacionOficina=!1,t.disableInputs=!1},t.another=function(){a.resetForm("#frm-create-oficina"),t.recordCreated=!1,t.disableInputs=!1},t.closeAddOffice=function(){t.disableInputs=!1,t.ocultaDetalleOficina=!1,t.ocultaFormCreacionOficina=!1},t.setScroll=function(e){if(5<e.length)return"setScroll"},t.cierraDetalles=function(){t.resultResource=!1,t.integrantesOficina=[]},t.cancelDelete=function(){t.selectedIdResource=""},t.resetForm=function(){t.item="",t.piso="",t.disableInputs=!1},t.mensajeErrorOficina="",t.muestraErrorOficina=!1,t.typeAlert="",t.deleteProcessOficina=function(e){s.post(baseurl+"oficinas/delete",{id_sg_oficina:e}).then(function(e){e.data.status?(t.mensajeErrorOficina=e.data.message,t.muestraErrorOficina=!0,t.typeAlert="success",t.disableInputs=!1,t.readOficinas()):(t.mensajeErrorOficina=e.data.message,t.muestraErrorOficina=!0,t.typeAlert="danger",t.disableInputs=!1),o(function(){t.muestraErrorOficina=!1},2500)})},t.editarOficina=function(){t.requestDetails(t.idOficina),t.buttonCreateOficina=!1,t.ocultaDetalleOficina=!0,t.ocultaFormCreacionOficina=!0},t.messageEmpleados="",t.dataEmpleados=[],t.readEmpleados=function(){var e=s.post(baseurl+"empleados/readbyempresa",{uid:uid});t.messageEmpleados="Verificando ...",e.then(function(e){e.data.status?(t.loadDataEmpleados=!0,t.dataEmpleados=e.data.rows,t.messageEmpleados=""):(t.loadDataEmpleados=!1,t.messageEmpleados="No encontramos empleados")})},t.readEmpleados(),t.listarIntegrantes=!1,t.abrirIntegrantes=function(){t.listarIntegrantes=!0,t.ocultaDetalleOficina=!0},t.cierraIntegrantes=function(){t.listarIntegrantes=!1,t.ocultaDetalleOficina=!1},t.selectedEmpleado=0,t.muestraAsignacion=function(e){t.selectedEmpleado=e},t.asignaEmpleado=function(e){t.asignacionEmpleado=e},t.cancelAsignacion=function(){t.asignacionEmpleado=0},t.asignadoEmpleado=!1,t.muestraErrorAsignacion=!1,t.mensajeErrorAsignacion="",t.tipoMensaje="",t.procesaAsignacion=function(a,e){s.post(baseurl+"oficinas/asignaempleado",{idEmpleado:e,idOficina:a,idUser:uid}).then(function(e){e.data.status?(t.asignadoEmpleado=!0,t.asignacionEmpleado=0,t.muestraErrorAsignacion=!0,t.mensajeErrorAsignacion=e.data.message,t.tipoMensaje="success",t.requestDetails(a)):(t.muestraErrorAsignacion=!0,t.mensajeErrorAsignacion=e.data.message,t.tipoMensaje="danger")}),o(function(){t.muestraErrorAsignacion=!1},2500)},t.empleadoAsignado=0,t.removerEmpleadoOficina=function(e){t.empleadoAsignado=e},t.cancelaRemover=function(){t.empleadoAsignado=0},t.eliminaEmpleadoOficina=function(e,a){s.post(baseurl+"oficinas/deleteasignacion",{id_sg_personal:e}).then(function(e){e.data.status&&(t.requestDetails(a),t.empleadoAsignado=0)})},t.btnActualizaOficina="Actualizar",t.updateOficina=function(){var e=a.OnSubmitForm({form:"#frm-create-oficina",css:".required",route:baseurl+"oficinas/update",fields:"",clear:!1});if(1==e)return!1;t.btnActualizaOficina="Actualizando ...",e.then(function(e){e.data.status&&(t.oficinaMessage=e.data.message,t.recordCreated=!0,t.readOficinas()),t.btnActualizaOficina="Actualizar"})},t.noMostrarOficinas=!1,t.detalleOficinas=[],t.loadDetalleOficinas=!1,t.enableSearch=!1,t.showDetallesOficinas=function(){t.detalleOficinas=[],t.noMostrarOficinas=!0,t.loadDetalleOficinas=!0,s.post(baseurl+"oficinas/resumenempleadosoficina",{idUser:uid}).then(function(e){e.data.status?t.detalleOficinas=e.data.rows:t.detalleOficinas=[],t.loadDetalleOficinas=!1})},t.closeDetalleOficinas=function(){t.noMostrarOficinas=!1},t.enableSearchOption=function(){t.enableSearch=!0},t.closeSearchOption=function(){t.enableSearch=!1}}]);