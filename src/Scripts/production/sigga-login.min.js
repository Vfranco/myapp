"use strict";sigga.controller("login",["$scope","Core","Form","$http","$window",function(a,r,t,s,o){a.statusError=!1,a.btnStatusLogin=!1,a.messageError="",a.btnStart="Ingresar",a.checkStorage=function(){var t=o.location.hash;if(r.isEmpty(t)){var a=o.localStorage.getItem("paso");if(r.isEmpty(a))return!1;var e=JSON.parse(a);s.post(baseurl+"usuarios/changetiporegistro",{user:e.uid}).then(function(t){t.data.status&&o.localStorage.removeItem("paso")})}},a.checkStorage(),a.dologin=function(){t.validate("#frm-init-login",".required")?(a.statusError=!0,a.messageError="Ingrese sus datos, para crear su cuenta"):(a.btnStatusLogin=!0,a.btnStart="...",s.post("/authentication/login",{userAcl:a.user,passAcl:CryptoJS.MD5(a.pass).toString()}).then(function(t){t.data.status?(a.btnStart="Ingresando ...",s.post("/authentication/createsesion",{email:a.user}).then(function(t){t.data.status&&(o.location.href=t.data.redirect),a.btnStatusLogin=!0})):(a.statusError=!0,a.messageError=r.isEmpty(t.data.message)?"Usuario no registrado, crea tu cuenta Sigga":t.data.message,a.btnStatusLogin=!1,a.btnStart="Ingresar")}))}}]),sigga.controller("registro",["$scope","$http","Core","Form",function(a,e,t,r){a.statusError=!1,a.showStrongPassword=!1,a.btnStatusRegister=!1,a.messageError="",a.btnStart="Crear mi Cuenta",a.pass="",a.btnRegister=!0,a.acceptTerms=!1,a.typeError="danger",a.createdUser=!1,a.correo="",a.badEmail=!0,a.emailExist=!1,a.messageEmailExist="",a.checkEmail=function(){t.isEmpty(a.correo)?(a.emailExist=!1,a.messageEmailExist=""):a.correo.match(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/)?e.post(baseurl+"usuarios/checkemail",{correo:a.correo}).then(function(t){t.data.status,a.emailExist=!0,a.messageEmailExist=t.data.message}):a.btnRegister=!0},a.doRegister=function(){if(r.validate("#frm-init-register",".required"))a.statusError=!0,a.messageError="Por favor, ingresa tus datos para crear tu cuenta";else if(a.acceptTerms){a.btnStart="Estamos creado tu cuenta ...",a.btnStatusRegister=!0,a.btnRegister=!0;var t={nombres:a.nombres,apellidos:a.apellidos,correo:a.correo,plan:a.plan,pass:CryptoJS.MD5(a.pass).toString()};e.post(baseurl+"usuarios/create",t).then(function(t){t.data.status?(a.statusError=!0,a.typeError="success",a.messageError="Hemos creado tu cuenta Sigga!",a.createdUser=!0):(a.statusError=!0,a.typeError="danger",a.messageError=t.data.message),a.btnStart="Crear mi Cuenta",a.btnStatusRegister=!1})}else a.statusError=!0,a.typeError="danger",a.messageError="Por favor, acepta nuestro terminos y condiciones"},a.comparePasswords=function(){return a.confirm!=a.pass?(a.btnRegister=!0,"Las contraseñas no coinciden"):a.correo.match(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/)?void(a.btnRegister=!1):"Bien, coinciden"},a.howStrongIsPassword=function(){if(!(t.isEmpty(a.pass)||a.pass.length<=0))return a.pass.length<=4?"Muy Debil":5<=a.pass.length?a.pass.match(/[\d+]/g)?a.pass.match(/[\w+].+[\d+]/g)?a.pass.match(/[*@"#$%&/)(]/)?(a.btnRegister=!1,"Esa es una buena contraseña"):a.pass.match(/0-9/g)?"Va bien, un caracter especial, y estaria lista!":a.pass.match(/[\w+]/g)?(a.btnRegister=!1,"Algo Fuerte"):"Muy Fuerte":a.pass.match(/[w+].+[\d+]*./g)?(a.btnRegister=!0,"Combinala, con letras tambien"):a.pass.match(/0-9/g)?(a.btnRegister=!0,"Bien, esa es una buena contraseña"):(a.btnRegister=!0,"Algun, numero estaria bien"):(a.btnRegister=!0,"Medio Fuerte"):void 0;a.btnRegister=!0}}]);